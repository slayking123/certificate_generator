<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../CSS/template.css">
    <script src="../js/jquery.min.js"></script>
    <style>
        body{
      background-color: #1F1D36;
  }
  .hr1{
    min-height: 10px;
    background-color: #F3F0D7;
  }
  .hd1{
    color: rosybrown;
    display: flex;
    justify-content: center;
    padding-top: 5px;
  }
    </style>
</head>
<body>
  <div class="hd1">
    <h1 >This is your preview!!!!</h1>
  </div>
    <div id="preview">
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://unpkg.com/jspdf@latest/dist/jspdf.umd.min.js"></script>

    <script>
      async function getdata()
        {
            var data;
           await fetch('http://localhost:4000/generate/'+localStorage.getItem("id")).then(res=>{
               return res.json()
            }).then(msg=>data=msg)
            let preview=document.querySelector('#preview')
            console.log(data)
            for(let i=0;i<data.length;i++)
            {
                const div=document.createElement('div')
                div.setAttribute('class','d1')
                div.setAttribute('id','c-'+i)
                div.onclick=(()=>{
                    return convert_pdf('c-'+i)
                })
                let hr=document.createElement('div')
                // hr.setAttribute('size','10px')
                hr.setAttribute('class','hr1')
                div.innerHTML=` 
                <div class="d2">
                <div class="d3">
                    <img class="m1" src="https://www.rcciit.org/images/logo.png" alt="">
                    <span  class="s1" style="font-weight:bold">Certificate of participation</span>
                </div>
                <!-- <img class="m1" src="https://www.rcciit.org/images/logo.png" alt="">
                <span  class="s1" style="font-weight:bold">Certificate of participation</span> -->
                   <br><br>
                   <span style="font-size:25px"><i>This is to certify that</i></span>
                   <br><br>
                   <span style="font-size:30px"><b>${data[i]["studentname"]}</b></span><br/><br/>
                   <span style="font-size:25px"><i>has participated in</i></span> <br/><br/>
                   <span style="font-size:30px">${data[i]["certificatename"]}</span> <br/><br/>
                   <span style="font-size:20px">of ${data[i]["branch"]}</span> <br/><br/><br/><br/>
                   <span style="font-size:25px"><i>dated</i></span><br>
                   
                  <span style="font-size:30px">20/07/2021</span>
            </div> `
            preview.appendChild(div)
            preview.appendChild(hr)
            }  
        }
//         function pdf(id)
//         {
//             console.log(id);
//             var cid='#'+id
//             var doc = new jsPDF();          
// var elementHandler = {
//   cid: function (element, renderer) {
//     return true;
//   }
// };
// var source = window.document.getElementsByTagName("body")[0];
// doc.fromHTML(
//     source,
//     15,
//     15,
//     {
//       'width': 180,'elementHandlers': elementHandler
//     });

// doc.output("dataurlnewwindow");
//         }
        getdata();
    </script>
    <script src="../js/jspdf.debug.js"></script>
    <script src="../js/html2canvas.min.js"></script>
    <script src="../js/html2pdf.min.js"></script>
    <script>

      const options = {
        margin: 7 -5,
        filename: 'invoice.pdf',
        image: { 
          type: 'jpeg', 
          quality: 500
        },
        html2canvas: { 
          scale: 1 
        },
        jsPDF: { 
          unit: 'in', 
          format: 'letter', 
          orientation: 'portrait' 
        }
      }
      
      function convert_pdf(id){
        // e.preventDefault();
        const element = document.getElementById(id);
        html2pdf().from(element).set(options).save();
      };
  
  
      function printDiv(divName) {
       var printContents = document.getElementById(divName).innerHTML;
       var originalContents = document.body.innerHTML;
  
       document.body.innerHTML = printContents;
  
       window.print();
  
       document.body.innerHTML = originalContents;
  }
      </script>
  
</body>
</html>